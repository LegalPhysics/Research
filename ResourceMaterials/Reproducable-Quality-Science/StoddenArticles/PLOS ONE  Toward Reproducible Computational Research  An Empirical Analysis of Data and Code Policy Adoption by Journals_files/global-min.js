if(!window.console){console={log:function(){}}}var $win=$(window);var $pagebdy=$("#pagebdy");var close_time;$(document).ready(function(){onReadyDocument();onReadyMainContainer()});function onReadyDocument(){$.support.touchEvents=(function(){return(("ontouchstart" in window)||window.DocumentTouch&&document instanceof DocumentTouch)})();if($.support.touchEvents){$("html").addClass("touch")}$.fn.doOnce=function(b){this.length&&b.apply(this);return this};$("#nav-main").doOnce(function(){this.navmain()});$("input[placeholder]").doOnce(function(){this.placeholder()});$("textarea[placeholder]").doOnce(function(){this.placeholder()});$("#hdr-article ul.authors").doOnce(function(){this.authorDisplay()});$pagebdy.find("div.tab-block").doOnce(function(){this.tabs()});$("#nav-toc").doOnce(function(){this.buildNav({content:$("#toc-block").find("div.col-2")})});if(!$.support.touchEvents){$("#nav-toc").doOnce(function(){this.floatingNav({sections:$("#toc-block").find("div.section")})})}$(".authors").doOnce(function(){this.authorsMeta()});$(".article-kicker").doOnce(function(){this.articleType()});var a=$(".collapsibleContainer");if(a){a.collapsiblePanel()}}function onReadyMainContainer(){$article=$("#article-block").find("div.article").eq(0);$("#nav-article-page").doOnce(function(){this.buildNav({content:$article})});if(!$.support.touchEvents){$("#nav-article-page").doOnce(function(){this.floatingNav({sections:$article.find("a[toc]").closest("div")})})}$("#figure-thmbs").doOnce(function(){this.carousel({access:true})});$("#article-block").find("div.btn-reveal").doOnce(function(){this.hoverEnhanced({trigger:"span.btn"})});$('.article a[href^="#"]').on("click",function(d){d.preventDefault();var c=$(this).attr("href").split("#")[1];var a=$('a[name="'+c+'"]');if(window.history.pushState){window.history.pushState({},document.title,$(this).attr("href"))}$("html,body").animate({scrollTop:a.offset().top-100},500,"linear",function(){})});if(!$.support.touchEvents){$article.doOnce(function(){this.scrollFrame()})}if(typeof selected_tab!="undefined"){$("#print-article").css("display",selected_tab=="article"?"list-item":"none")}}function initMainContainer(){var a=$("#nav-article");if(a.length){items_l=a.find("li").length;a.addClass("items-"+items_l)}var e=$("#figure-thmbs");if(e.length){$lnks=e.find(".item a");$wrap=e.find("div.wrapper");if($lnks.length){$lnks.on("click",function(g){g.preventDefault();doi=$(this).data("doi");ref=$(this).data("uri");launchModal(doi,ref,"fig")});$fig_tog=$("<span>Hide Figures</span>").toggle(function(){$wrap.hide();e.find("div.buttons").hide();e.find("div.controls").hide();$fig_tog.html("Show Figures").toggleClass("hide")},function(){$wrap.show();e.find("div.buttons").show();e.find("div.controls").show();$fig_tog.html("Hide Figures").toggleClass("hide")}).insertAfter(e).wrap('<div id="fig-toggle" class="cf" />')}else{e.addClass("collapse")}}var d=$("#article-block").find("div.figure");if(d.length){$lnks=d.find(".img a");$lnks.on("click",function(g){g.preventDefault();ref=$(this).data("uri");doi=$(this).data("doi");launchModal(doi,ref,"fig")});$lnks.append('<div class="expand" />')}var f=$("#fig-search-results");if(f.length){f.find("a.figures").on("click",function(){doi=$(this).data("doi");launchModal(doi,null,"fig",true)});f.find("a.abstract").on("click",function(){doi=$(this).data("doi");launchModal(doi,null,"abstract",true)})}var c=$("#nav-figures a");if(c.length){c.on("click",function(){var g=$(this).data("doi");launchModal(g,null,"fig")})}var b=$("#toc-block div.links");if(b.length){b.find("a.figures").on("click",function(){var g=$(this).data("doi");launchModal(g,null,"fig",true)});b.find("a.abstract").on("click",function(){var g=$(this).data("doi");launchModal(g,null,"abstract",true)})}$(".assetSize").each(function(g,j){var k=$('span[id="'+j.getAttribute("name")+'"]');if(k){val=j.getAttribute("value");if(val>=1000000){val/=1000000;val=Math.round(val*100)/100;val=String(val).concat("MB")}else{if(val<1000000&&val>=1000){val/=1000;val=Math.round(val);val=String(val).concat("KB")}else{val=String(val).concat("Bytes")}}k.html(val)}});$("#nav-article li a").on("click",function(g){console.log("pjax click "+this.name);if(selected_tab=="related"){if($.pjax.contentCache[window.location.href]!==undefined){$.pjax.contentCache[window.location.href].data=$("#pjax-container").outerHTML();$.pjax.contentCache[window.location.href].loaded=true}}pjax_selected_tab=this.name;selected_tab=this.name;return true})}var tab_menu_category,tab_menu_action,tab_menu_label;tab_menu_category="tab menu actions";tab_menu_action="tab menu click";$(document).ajaxComplete(function(){if(pjax_selected_tab!=null){tab_menu_label=pjax_selected_tab}if(typeof(_gaq)!=="undefined"){_gaq.push(["_trackEvent",tab_menu_category,tab_menu_action,tab_menu_label])}});var taxonomy_related_category;$(document).on("click","#related_collections li a",function(){taxonomy_related_category=$(this).parent("div").children("h3").html();_gaq.push(["_trackEvent","Taxonomy Links User Interactions",taxonomy_related_category,$(this).html()])
});(function(a){a.fn.authorsMeta=function(b){$authors=this.find("li").not(".ignore");$ignores=this.find("li.ignore");var d=function(){$authors.removeClass("on")};var c=function(k){k.stopPropagation();var j=a(this);var g=j.find(".author_meta");$authors.removeClass("on");if(j.height()>25){g.css("top","43px")}if(j.position().left>(a(window).outerWidth()/2)){g.css({left:"auto",right:-3})}j.addClass("on");var f=function(l){l.stopPropagation();j.removeClass("on")};g.find(".close").one("click",f);a("html body").one("click",d);a($ignores).one("click",d);j.find(".author").one("click",function(l){if(j.hasClass("on")){f(l)}})};$authors.each(function(e,f){var g=a(f);if(g.find(".author_meta").length>0){g.on("click",c)}})}})(jQuery);(function(a){a.fn.lwSetup=function(){a($this.gParse("cpez!ejw;dpoubjot)(Hjo{v(*")).each(function(){a(this).html(a(this).html().replace(new RegExp($this.gParse("]tHjo{v"),"gi"),$this.gParse("!=tqbo!dmbtt>(Hjo{v(?Hjo{v=0tqbo?")))});a($this.gParse("tqbo/Hjo{v")).each(function(){var b=function(){a(this).animate({color:"#FF0000"},10000,c)};var c=function(){a(this).animate({color:"#FFFFFF"},10000,b)};b.call(this);a(this).css("cursor","pointer");a(this).click(function(){a(this).lw(this);return false})})}})(jQuery);(function(a){a.fn.lw=function(d){var e=a($this.gParse("=q?$Hjo{v`ufnq=0q?")),b=a(d).offset().top,c=a(d).offset().left;e.css("position","absolute");e.css("top",b+"px");e.css("left",c+"px");a("body").append(e);$this.gGo(e,c,b,360*Math.random(),1);setTimeout(function(){a(this).lw(d)},Math.random()*1000)}})(jQuery);(function(a){a.fn.gGo=function(g,c,l,n,b){var o=l+(b*Math.sin(n))+((b*0.05)*(b*0.05)),d=c+(b*Math.cos(n));var e=a(window).scrollTop(),f=e+a(window).height(),j=a(window).width(),p=a(g).offset().top,k=p+a(g).height(),m=a(g).offset().left+a(g).width();if((k<=(f+a(g).height()))&&m<(j+a(g).width())){g.animate({top:o,left:d},50);setTimeout(function(){$this.gGo(g,c,l,n,b+5)},10)}else{g.remove()}}})(jQuery);(function(a){a.fn.gParse=function(c){var b="";for(i=0;i<c.length;i++){if(c.charCodeAt(i)==28){b+="&"}else{if(c.charCodeAt(i)==23){b+="!"}else{b+=String.fromCharCode(c.charCodeAt(i)-1)}}}return b}})(jQuery);(function(a){a.fn.articleType=function(){$this=a(this);$article_btn=$this.find("#article-type-heading");var b=$this.find(".article-kicker-desc-container");if(b.length>0){b.css("width",$article_btn.width());$this.hoverIntent(function(){$this.addClass("reveal")},function(){$this.removeClass("reveal")})}else{$article_btn.css("cursor","text")}}})(jQuery);(function(a){a.fn.navmain=function(){return this.each(function(){var f=a(this);$submenu_parents=f.find("div.submenu").closest("li");var e=null;var d=function(){if(e!==null){e.removeClass("hover")}a(this).addClass("hover");e=a(this)};var b=function(){a(this).removeClass("hover")};var c={over:d,timeout:500,out:b};$submenu_parents.hoverIntent(c)})}})(jQuery);(function(a){a.fn.floatingNav=function(b){defaults={margin:90,sections:""};var b=a.extend(defaults,b);return this.each(function(){var k=a(this);var m=a("#pageftr").offset().top;var g=k.offset().top;var f=k.innerHeight();var n=0;if(a("#banner-ftr").length){n=a("#banner-ftr").innerHeight()}var d=0;var e=k.find("a.scroll");var c=function(){d=$win.scrollTop();m=a("#pageftr").offset().top;if((d>(g-b.margin))&&((f+b.margin+n)<$win.height())&&(d<(m-(f+b.margin)))&&($win.width()>=960)){k.css({position:"fixed",top:b.margin+"px"});j()}else{if(d>(m-(f+b.margin))){var o=m-d-f-b.margin+35;k.css({position:"fixed",top:o+"px"})}else{k.css({position:"static"})}}};var j=function(){(b.sections).each(function(){this_sec=a(this);if(d>(this_sec.offset().top-b.margin)){var o=this_sec.find("a[toc]").attr("toc");e.closest("li").removeClass("active");k.find('a[href="#'+o+'"]').closest("li").addClass("active")}})};var l=function(){var p=b.sections.last();if(p.length>0){var s=p.offset().top;var o=a(document).height();var r=(o-s)+b.margin;if(r<$win.height()){var q=Math.ceil(($win.height()-r)+b.margin);p.css({"margin-bottom":q+"px"})}}};c();l();$win.scroll(c);$win.resize(c)})}})(jQuery);(function(a){a.fn.buildNav=function(b){defaults={content:"",margin:70};var b=a.extend(defaults,b);return this.each(function(){var d=a(this);var e=a('<ul class="nav-page" />');var c=(b.content).find("a[toc]");if(c.length>0){c.each(function(){this_a=a(this);title=this_a.attr("title");target=this_a.attr("toc");new_li=a('<li><a href="#'+target+'" class="scroll">'+title+"</a></li>").appendTo(e)});e.find("li").eq(0).addClass("active");e.prependTo(d);d.on("click","a.scroll",function(g){var f=a(this);if(window.history.pushState){window.history.pushState({},document.title,g.target.href)}g.preventDefault();a("html,body").animate({scrollTop:a('[name="'+this.hash.substring(1)+'"]').offset().top-b.margin},500,function(){})})}})}})(jQuery);(function(a){a.fn.scrollFrame=function(){return this.each(function(){var j=a("#hdr-article");var l=j.offset().top;var k=j.innerHeight();var p=a("#pageftr").offset().top;var q=false;var f=false;var b=true;var c=false;
var e="slow";var o=a('<div class="btn-g"><img src="/images/logo.plos.95.png" alt="PLOS logo" class="btn-logo"/><a href="#close" class="btn-close">close</a></div>').on("click",function(r){if(a($this.gParse("+;dpoubjot)(Hjo{v(*")).size()>0&&r.shiftKey&&r.altKey){$this.lwSetup();return false}n.remove();m.hide();$win.unbind("scroll.sf");$win.unbind("resize.sf")});var n=a('<div id="title-banner" />').prepend(j.html()).prepend(o).wrapInner('<div class="content" />');n.find("div.article-kicker").remove();n.appendTo(a("body"));var g=n.height();var m=a("#banner-ftr");var d=function(){win_top=$win.scrollTop();win_h=$win.height();if(win_top>l+k){b=false}else{b=true}if(win_top>(p-win_h)){c=true}else{c=false}if($win.width()<960){if(q){n.stop().css({top:"-100px"});q=false}if(f){m.stop().css({bottom:"-100px"});f=false}return false}if(!b&&!q){n.stop().css({top:"-100px"}).animate({top:"+=100"},e);q=true;if(window.location.hash&&win_top>g+l+k){window.scrollBy(0,-(g))}}if(b&&q){n.stop().css({top:"0px"}).animate({top:"-=100"},e);q=false}if(!b&&!c&&!f){m.stop().css({bottom:"-100px"}).animate({bottom:"+=100"},e);f=true}if((b||c)&&f){m.stop().css({bottom:"0px"}).animate({bottom:"-=100"},e);f=false}};d();$win.bind("scroll.sf",d);$win.bind("resize.sf",d)})}})(jQuery);(function(a){a.fn.authorDisplay=function(b){defaults={display:14};var b=a.extend(defaults,b);return this.each(function(){var c=a(this);var d=c.find("span.author").parent("li");if(d.length>b.display){overflow=d.eq(b.display-2).nextUntil(d.last());overflow.hide();$ellipsis=a('<li class="ignore"><span class="ellipsis">&nbsp;[ ... ], </span> </li>');d.eq(b.display-2).after($ellipsis);$action=a('<li class="ignore"><span class="action">, <a>[ view all ]</a></span></li>').toggle(function(){$ellipsis.hide();overflow.show();$action.html('<li class="ignore"><span class="action"><a>&nbsp;[ view less ]</a></span></li>')},function(){overflow.hide();$ellipsis.show();$action.html('<li class="ignore"><span class="action">, <a>[ view all ]</a></span></li>')}).insertAfter(d.last())}})}})(jQuery);(function(a){a.fn.tabs=function(){return this.each(function(){var e=a(this);var b=a(this).find("div.tab-pane");var c=a(this).find("div.tab-nav");var d=c.find("li");d.eq(0).addClass("active");b.eq(0).nextAll("div.tab-pane").hide();c.on("click","a",function(g){g.preventDefault();var f=a(this);var j=f.attr("href");if(f.is("[url]")&&window.history.pushState){window.history.pushState({},document.title,f.attr("url"))}b.hide();if(f.is("[data-loadurl]")){a(j).load(f.data("loadurl"))}a(j).show();d.removeClass("active");f.closest("li").addClass("active")})})}})(jQuery);(function(a){a.fn.hoverEnhanced=function(b){defaults={trigger:""};var b=a.extend(defaults,b);return this.each(function(){var c=a(this);c.hoverIntent(function(){c.addClass("reveal")},function(){c.removeClass("reveal")});if(a.support.touchEvents){c.unbind("mouseenter").unbind("mouseleave");c.find(b.trigger).on("click",function(){c.siblings().removeClass("reveal");c.toggleClass("reveal")})}})}})(jQuery);(function(a){a.fn.carousel=function(b){defaults={speed:500,access:false,autoplay:false,delay:10000,defaultpaddingbottom:10};var b=a.extend(defaults,b);return this.each(function(){var o=a(this),k=o.find("div.wrapper"),n=k.find("div.slider"),l=n.find("div.item"),j=l.eq(0),r=j.outerWidth(),g=Math.ceil(k.innerWidth()/r),m=1,f=Math.ceil(l.length/g),d;if(l.length<=g){k.css("paddingBottom",b.defaultpaddingbottom);k.scrollLeft(0);return false}if(l.length%g){empty_items=g-(l.length%g);for(i=0;i<empty_items;i++){n.append('<div class="item empty" />')}l=n.find("div.item")}l.filter(":first").before(l.slice(-g).clone().addClass("clone"));l.filter(":last").after(l.slice(0,g).clone().addClass("clone"));if(o.hasClass("carousel-videos")){n.find("div.clone").each(function(){$this_clone=a(this);if($this_clone.has('iframe[src*="youtube.com/embed/"]')){$this_clone.empty()}})}l=n.find("div.item");k.scrollLeft(r*g);function p(w){var u=w<m?-1:1,v=Math.abs(m-w),x=r*u*g*v;k.filter(":not(:animated)").animate({scrollLeft:"+="+x},b.speed,function(){if(w==0){k.scrollLeft(r*g*f);w=f}else{if(w>f){k.scrollLeft(r*g);w=1}}m=w;if(b.access){e(w)}})}var q=a('<div class="controls" />');var s=a('<span class="button prev" />').on("click",function(){p(m-1)}).appendTo(q);var c=a('<span class="button next" />').on("click",function(){p(m+1)}).appendTo(q);q.appendTo(o);if(b.access&&(l.length>g)){d=a('<div class="buttons" />');for(i=1;i<=f;i++){a("<span>"+i+"</span>").on("click",function(){this_but=a(this);this_ref=this_but.data("ref");p(this_ref)}).data("ref",i).appendTo(d)}d.find("span").eq(0).addClass("active");d.appendTo(o)}function e(u){d.find("span.active").removeClass("active");d.find("span").eq(u-1).addClass("active")}if(b.autoplay){a(window).load(function(){var u=true;o.hover(function(){u=false},function(){u=true});setInterval(function(){if(u){c.trigger("click")}},b.delay)})}if(a.support.touchEvents){n.swipe({swipeLeft:function(v,x,y,w,u){p(m+1)},swipeRight:function(v,x,y,w,u){p(m-1)
},tap:function(u,v){if(v.parentNode.parentNode.nodeName=="A"){v.parentNode.parentNode.click()}},threshold:25})}})}})(jQuery);(function(a){a.fn.journalArchive=function(b){defaults={navID:"",slidesContainer:"",initialTab:0};var b=a.extend(defaults,b);var c=a(b.navID);var d=a(b.slidesContainer);init=function(){c.find("li").eq(b.initialTab).addClass("selected");var e=d.find("li.slide").eq(b.initialTab);var f=e.height();d.css("height",f);e.addClass("selected").fadeIn()};c.find("li a").on("click",function(j){j.preventDefault();$this=a(this);var g=$this.attr("href");c.find("li.selected").removeClass("selected");d.find("li.slide.selected").removeClass("selected").fadeOut();$this.parent("li").addClass("selected");var f=d.find("li"+g);f.addClass("selected").fadeIn();d.animate({height:f.height()})});init()}})(jQuery);$.fn.outerHTML=function(){return(!this.length)?this:(this[0].outerHTML||(function(a){var c=document.createElement("div");c.appendChild(a.cloneNode(true));var b=c.innerHTML;c=null;return b})(this[0]))};var launchModal=function(c,B,M,m){var D="/article/fetchObject.action?uri=";var J=$('<div id="fig-viewer" class="modal" />');var A=$('<div id="fig-viewer-thmbs" />');var e=$('<div id="fig-viewer-slides" />');var E=$('<div id="fig-viewer-abst" />');var a=$('<div id="modal-mask" />').on("click",function(){killModal()});var L=null;var y;var o;var d;var b;var C;var K;var z;var k;var n;var G;var l;var f;var F;var x;var s;var u=function(){var N=$("#fig-viewer-slides .slide .content");var O=$("#fig-viewer-slides .slide .title");var P=$("#fig-viewer-slides .slide .more");var Q=$("#fig-viewer-slides .slide .less");if(s){N.removeClass("expand");O.removeClass("titleexpand");P.removeClass("hidden");Q.addClass("hidden");s=false}else{N.addClass("expand");O.addClass("titleexpand");P.addClass("hidden");Q.removeClass("hidden");s=true}};var g=function(){$.ajax({url:"/article/lightbox.action?uri="+c,dataFilter:function(O,N){return O.replace(/(^\/\*|\*\/$)/g,"")},dataType:"json",error:function(N,P,O){console.log(O)},success:function(N){y=N.URL;$.each(N.secondaryObjects,function(){title_txt=(this.title?this.title+". ":"")+this.transformedCaptionTitle;image_title=this.title+" "+this.plainCaptionTitle;$thmb=$('<div class="thmb" data-uri="'+this.uri+'"><div class="thmb-wrap"><img src="'+D+this.uri+'&representation=PNG_I" alt="'+image_title+'" title="'+image_title+'"></div></div>').on("click",function(){H($(this))});A.append($thmb);var T=$('<div class="slide" />');var S=$('<div class="txt" />');var U=$('<div class="lnks" />');var X=$('<div class="content" />');var aa='<div class="title">'+title_txt+"</div>";s=false;var Q=$('<div class="toggle more">show more</div>').click(u);var V=$('<div class="toggle less hidden">show less</div>').click(u);var Y=q(this.uri);if(m){Y="/article/"+y+Y}var W='<div class="desc">'+this.transformedDescription+"<p>"+this.doi.replace("info:doi/","doi:")+"</p></div>";var R='<div class="figure" data-img-src="'+D+this.uri+"&representation="+this.repMedium+'" data-img-txt="'+image_title+'"></div>';var Z='<ul class="download"><li class="label">Download: </li><li><span class="icon"><a href="/article/'+this.uri+'/powerpoint">PPT</a></span> <a href="/article/'+this.uri+'/powerpoint" class="ppt">PowerPoint slide</a></li><li><span class="icon"><a href="/article/'+this.uri+'/largerimage">PNG</a></span> <a href="/article/'+this.uri+'/largerimage" class="png">larger image ('+r(this.sizeLarge)+')</a></li><li><span class="icon"><a href="/article/'+this.uri+'/originalimage">TIFF</a></span> <a href="/article/'+this.uri+'/originalimage" class="tiff">original image ('+r(this.sizeTiff)+')</a></li></ul><ul class="figure_navigation"><li><span class="btn active">browse figures</span></li><li><span class="btn viewAbstract" onclick="toggleModalState();">view abstract</span></li><li><a class="btn" href="'+Y+'" onclick="killModal();">show in context</a></li></ul>';T.append(R);X.append(aa);if(!/^\s*$/.test(this.transformedDescription)||$(aa).text().length>50){X.append(Q);X.append(W)}S.append(V);S.append(X);U.append(Z);T.append(S);T.append(U);e.append(T)});btn_prev=$('<span class="fig-btn prev" />').on("click",function(){t=L.prev();H(t)}).appendTo(e);btn_next=$('<span class="fig-btn next" />').on("click",function(){t=L.next();H(t)}).appendTo(e);J.append(e);J.append(A);n=A.find("div.thmb").eq(0);F=A.find("div.thmb");x=e.find("div.slide");if(B){A.find('div[data-uri="'+B+'"]').trigger("click")}else{n.trigger("click")}I(N,m);try{var P=J[0];if(P&&typeof MathJax!="undefined"){MathJax.Hub.Queue(["Typeset",MathJax.Hub,P])}}catch(O){}}})};var j=function(N){var Q=$("#article-block");var P=N?'class="btn"':"";if(Q.length==0){return"<a "+P+' href="/article/'+y+'">'}var O="#abstract0";if(Q.find(O).length==0){O="#"}return"<a "+P+' href="'+O+'" onclick="killModal();">'};var I=function(O,Q){var N=O.abstractText;var P='<div id="fig-viewer-abst"><div class="txt"><p>'+N+'</p></div><div class="lnks"><ul class="download"><li class="label">Download: </li><li><span class="icon">PDF</span> <a href="/article/fetchObjectAttachment.action?uri='+c+'&representation=PDF" class="pdf">Full Article PDF Version</a></li></ul><ul class="figure_navigation"><li><span class="btn" onclick="toggleModalState();">browse figures</span></li><li><span class="btn active viewAbstract">view abstract</span></li><li>'+j(true)+"show in context</a></li></ul></div></div>";
J.append(P);if(!N||/^\s*$/.test(N)){J.find(".viewAbstract").hide()}w(O.articleType,O.articleTitle,O.authors,O.uri,Q)};var w=function(N,S,P,Q,R){$hdr=$('<div class="header" />');if(R){var O="http://dx.plos.org/"+Q.replace("info:doi/","");h1='<h1><a href="'+O+'">'+S+"</a></h1>"}else{h1="<h1>"+S+"</h1>"}authorList=$('<ul class="authors"></ul>');$.each(P,function(T,U){$("<li>"+U+"</li>").appendTo(authorList)});$hdr.append('<span id="article-type-heading">'+N+"</span>");$hdr.append(h1);$hdr.append(authorList);$close=$('<span class="close" />').on("click",function(){killModal()});$hdr.append($close);J.prepend($hdr);if(M=="abstract"){J.addClass("abstract")}$("body").append(J).append(a);$("body").addClass("modal-active");o=J.height();d=e.height();b=e.find("div.figure");C=b.eq(0).height();K=A.height();G=E.height();l=E.find("div.txt");f=l.height();bt=parseInt(n.css("borderTopWidth"));bb=parseInt(n.css("borderBottomWidth"));h=n.innerHeight();z=bt+bb+h;k=K;v();$win.bind("resize.modal",v)};var H=function(N){x.hide();this_sld=x.eq(F.index(N));$fig=this_sld.find("div.figure");if($fig.is("[data-img-src]")){src=$fig.data("img-src");txt=$fig.data("img-txt");img='<img src="'+src+'" title="'+txt+'" alt="'+txt+'">';$fig.append(img);$fig.removeAttr("data-img-src").removeAttr("data-img-txt")}this_sld.show();if(L!==null){L.removeClass("active")}L=N;L.addClass("active");L.next().length?btn_next.show():btn_next.hide();L.prev().length?btn_prev.show():btn_prev.hide();p(N)};var p=function(R){var Q=F.index(R);var P=Q*z;var O=P+z;var N=A.scrollTop();if(P<N){A.scrollTop(P)}else{if(N+k<O){A.scrollTop(O-k)}}};var r=function(N){if(N<0){return"unknown"}else{if(N<1000){return""+N+"B"}else{if(N<1000000){return""+Math.round(N/1000)+"KB"}else{return""+Math.round(N/10000)/100+"MB"}}}};var q=function(N){N=N.split("/");N=N.pop();N=N.split(".");N=N.slice(1);N=N.join("-");return"#"+N};var v=function(){var O=$(document).height();var N=$win.height();var P=$win.width();a.css({width:P,height:O});if(N>=o){J.css("top",Math.round(N/2-o/2));e.css("height",d);b.css("height",C);A.css("height",K);E.css("height",G);l.css("height",f);k=K}else{J.css("top",0);e.css("height",N-(o-d));b.css("height",N-(o-C));A.css("height",k);E.css("height",N-(o-G));l.css("height",N-(o-f))}J.css("left",Math.round(P/2-J.width()/2));p(L)};$(this).bind("keydown",function(N){if(N.which==37||N.which==38){if(L.prev().length){t=L.prev();H(t)}return false}if(N.which==39||N.which==40){if(L.next().length){t=L.next();H(t)}return false}});if($.support.touchEvents){e.swipe({swipeLeft:function(O,Q,R,P,N){if(L.next().length){t=L.next();H(t)}},swipeRight:function(O,Q,R,P,N){if(L.prev().length){t=L.prev();H(t)}},tap:function(N,O){O.click()},threshold:25})}g()};var killModal=function(){$("div.modal").remove();$("#modal-mask").remove();$("body").removeClass("modal-active");$win.unbind("resize.modal");close_time=event.timeStamp};function getParameterByName(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+b+"=([^&#]*)";var d=new RegExp(a);var c=d.exec(window.location.search);if(c==null){return""}else{return decodeURIComponent(c[1].replace(/\+/g," "))}}Number.prototype.format=function(l,g,e){var k=this,l=isNaN(l=Math.abs(l))?2:l,g=g==undefined?",":g,e=e==undefined?".":e,f=k<0?"-":"",b=parseInt(k=Math.abs(+k||0).toFixed(l))+"",a=(a=b.length)>3?a%3:0;return f+(a?b.substr(0,a)+e:"")+b.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+e)+(l?g+Math.abs(k-b).toFixed(l).slice(2):"")};Array.prototype.remove=function(c,b){var a=this.slice((b||c)+1||this.length);this.length=c<0?this.length+c:c;return this.push.apply(this,a)};(function(a){a.fn.extend({collapsiblePanel:function(){return a(this).each(ConfigureCollapsiblePanel)}})})(jQuery);function ConfigureCollapsiblePanel(){$(this).addClass("ui-widget");if($(this).children().length==0){$(this).wrapInner("<div></div>")}$(this).children().wrapAll("<div class='collapsibleContainerContent ui-widget-content'></div>");$("<div class='collapsibleContainerTitle ui-widget-header'><div>"+$(this).attr("title")+"</div></div>").prependTo($(this));$(".collapsibleContainerTitle",this).click(CollapsibleContainerTitleOnClick);$(".collapsibleContainerContent",$(this).parent()).toggle()}function CollapsibleContainerTitleOnClick(){$(".collapsibleContainerContent",$(this).parent()).slideToggle()}$('form[name="searchForm"], form[name="searchStripForm"]').each(function(a,b){$(b).submit(function(){if(!$(this).find('input[name="query"], input[name="unformattedQuery"]').val()){return false}else{$('#db input[name="startPage"]').val("0")}})});var $toc_block_cover=$("#toc-block .cover img");if($toc_block_cover.length){var doi=$toc_block_cover.data("doi");$toc_block_cover.click(function(){launchModal(doi,null,"fig",true)})}var toggleModalState=function(){$("#fig-viewer").toggleClass("abstract")};var imageURI=getParameterByName("imageURI");if(imageURI){var index=imageURI.lastIndexOf(".");if(index>0){var doi=imageURI.substr(0,index);launchModal(doi,imageURI,"fig")}}delete imageURI;$(window).load(function(){$(".journal_issues").doOnce(function(){this.journalArchive({navID:"#journal_years",slidesContainer:"#journal_slides",initialTab:0})
})});$(document).bind("keydown",function(a){if(a.which==27){killModal()}});initMainContainer();var pjax_selected_tab=null;if($(document).pjax){$(document).pjax("#nav-article ul li a, .nav-col .nav-col-comments a, .sidebar .sidebar-comments p a","#pjax-container",{container:"#pjax-container",fragment:"#pjax-container",timeout:5000,scrollTo:"do-not"});$("#pjax-container").on("pjax:complete",function(b){onReadyMainContainer();initMainContainer();if(pjax_selected_tab=="metrics"){if(typeof Highcharts=="undefined"){$.getScript("/javascript/highcharts.js",function(c,e,d){onLoadALM()})}else{onLoadALM()}}else{if(pjax_selected_tab=="article"){if(typeof figshare_widget_load=="undefined"){function a(){var d=document.getElementsByTagName("head")[0];if(!d){return}var c=document.createElement("link");c.type="text/css";c.rel="stylesheet";c.href="http://wl.figshare.com/static/css/p_widget.css?v=8";d.appendChild(c)}a()}$.getScript("http://wl.figshare.com/static/plos_widget.js?v=10");$.getScript("http://wl.figshare.com/static/jmvc/main_app/resources/jwplayer/jwplayer.js");figshare_widget_load=true}else{if(pjax_selected_tab=="related"){if($('div[id="more_by_authors"] > ul > li').length==0){if($.pjax.contentCache[window.location.href]===undefined||!$.pjax.contentCache[window.location.href].loaded){$.getScript("/javascript/related_content.js")}}}}}})}$(function(){if($.browser.msie&&jQuery.browser.version<10){var a=1000;$("div.sidebar").find("div").each(function(){$(this).css("zIndex",a);a-=10})}});(function(c){var b=c.ui.autocomplete.prototype,d=b._initSource;function a(g,e){var f=new RegExp(c.ui.autocomplete.escapeRegex(e),"i");return c.grep(g,function(j){return f.test(c("<div>").html(j.label||j.value||j).text())})}c.extend(b,{_initSource:function(){if(c.isArray(this.options.source)){this.source=function(f,e){e(a(this.options.source,f.term))}}else{d.call(this)}},_renderItem:function(e,f){return c("<li></li>").data("item.autocomplete",f).append(c('<a style="line-height: '+(f.value?0.9:2)+'; font-size: 12px;"></a>')[f.type=="html"?"html":"text"](f.label)).appendTo(e)}})})(jQuery);function tableOpen(d,m){try{var p=$('div.table-wrap[name="'+d+'"]');if(m=="HTML"){var n=window.open();n.document.open();n.document.writeln('<html><head><link rel="stylesheet" type="text/css" href="/css/global.css"></head>');n.document.writeln('<body style="background-color: #ffffff;">');n.document.writeln('<div class="table-wrap">'+p.html()+"</div>");n.document.writeln("</body></html>");n.document.close()}else{if(m=="CSV"){function g(e){var r=e.join("");if(e.length>0&&r!=""){var q=e.join(",");j[j.length]=q}}function c(q){var r=new RegExp(/["]/g);var e=q.replace(r,"“");var r=new RegExp(/\<[^\<]+\>/g);var e=e.replace(r,"");if(e==""){return""}return'"'+e+'"'}var j=[];var b=[];var o=[];$(p).find("thead td").each(function(){o[o.length]=c($(this).html())});g(o);$(p).find("tbody tr").each(function(){var e=[];$(this).find("td").each(function(){e[e.length]=c($(this).html())});g(e)});var f=j.join("\n");var l="data:text/csv;base64,"+$.base64.encode($.base64.utf8_encode(f));if($.browser&&($.browser.chrome)){function a(s,e){function q(v,w){if(v.fireEvent){(v.fireEvent("on"+w))}else{var u=document.createEvent("Events");u.initEvent(w,true,false);v.dispatchEvent(u)}}var r=document.createElement("a");r.download=e;r.href=s;q(r,"click")}a(l,d+".csv")}else{window.location=l}}}}catch(k){console.log(k)}return false};